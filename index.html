<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TextLens Pro ‚Äî QA & Dev Analyzer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0d0d0f;
            --surface: #141416;
            --surface-2: #1a1a1d;
            --surface-3: #222226;
            --surface-hover: #2a2a2e;
            --border: #2d2d32;
            --border-hover: #404048;
            --border-accent: #4a4a52;
            --text: #f0f0f5;
            --text-muted: #8a8a95;
            --text-dim: #5a5a65;
            --accent: #00d9a3;
            --accent-dim: rgba(0, 217, 163, 0.08);
            --accent-hover: rgba(0, 217, 163, 0.15);
            --accent-glow: rgba(0, 217, 163, 0.25);
            --warning: #ffb347;
            --error: #ff6b6b;
            --info: #6bb5ff;
            --mono: 'JetBrains Mono', monospace;
            --sans: 'Inter', sans-serif;
            --shadow: 0 4px 20px rgba(0,0,0,0.4);
            --radius: 8px;
            --radius-sm: 4px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: var(--sans);
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.5;
        }

        /* Subtle grid pattern */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image: 
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 40px 40px;
            pointer-events: none;
            z-index: 9999;
        }

        .app {
            display: grid;
            grid-template-rows: auto 1fr;
            height: 100vh;
            overflow: hidden;
        }

        /* Header - Compact & Functional */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            gap: 16px;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-shrink: 0;
        }

        .brand-icon {
            width: 28px;
            height: 28px;
            background: var(--accent);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--mono);
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--bg);
        }

        .brand-text {
            font-family: var(--sans);
            font-weight: 600;
            font-size: 0.95rem;
            letter-spacing: -0.01em;
        }

        .brand-tag {
            font-family: var(--mono);
            font-size: 0.6rem;
            color: var(--text-dim);
            background: var(--surface-2);
            padding: 2px 6px;
            border-radius: 3px;
            border: 1px solid var(--border);
        }

        .header-center {
            flex: 1;
            display: flex;
            justify-content: center;
        }

        .quick-actions {
            display: flex;
            gap: 6px;
            background: var(--surface-2);
            padding: 4px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
        }

        .header-right {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        /* Buttons */
        .btn {
            font-family: var(--sans);
            font-size: 0.75rem;
            font-weight: 500;
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--surface-2);
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .btn:hover {
            background: var(--surface-hover);
            border-color: var(--border-hover);
            color: var(--text);
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: var(--accent);
            color: var(--bg);
            border-color: var(--accent);
            font-weight: 600;
        }

        .btn-primary:hover {
            background: #00e6b0;
            box-shadow: 0 0 15px var(--accent-glow);
        }

        .btn-icon {
            padding: 6px;
            font-size: 0.9rem;
        }

        .btn.active {
            background: var(--accent-dim);
            color: var(--accent);
            border-color: var(--accent);
        }

        /* Main Layout */
        .main {
            display: grid;
            grid-template-columns: 1fr 380px;
            overflow: hidden;
        }

        /* Editor Section */
        .editor-section {
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border);
            background: var(--bg);
        }

        .editor-toolbar {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
            scrollbar-width: none;
        }

        .editor-toolbar::-webkit-scrollbar { display: none; }

        .toolbar-group {
            display: flex;
            gap: 4px;
            padding-right: 12px;
            border-right: 1px solid var(--border);
            margin-right: 4px;
        }

        .toolbar-group:last-child {
            border-right: none;
            padding-right: 0;
            margin-right: 0;
        }

        .editor-wrapper {
            flex: 1;
            position: relative;
            padding: 16px;
        }

        textarea {
            width: 100%;
            height: 100%;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            color: var(--text);
            font-family: var(--mono);
            font-size: 0.875rem;
            line-height: 1.7;
            padding: 20px;
            resize: none;
            transition: all 0.2s;
            caret-color: var(--accent);
            tab-size: 2;
        }

        textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-dim);
        }

        textarea::placeholder { color: var(--text-dim); }

        .editor-status {
            position: absolute;
            bottom: 28px;
            right: 28px;
            display: flex;
            gap: 12px;
            font-family: var(--mono);
            font-size: 0.7rem;
            color: var(--text-dim);
            background: rgba(13, 13, 15, 0.9);
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid var(--border);
            backdrop-filter: blur(4px);
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .status-item.accent {
            color: var(--accent);
            font-weight: 600;
        }

        /* Stats Panel */
        .stats-panel {
            display: flex;
            flex-direction: column;
            background: var(--surface);
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--border) transparent;
        }

        .stats-panel::-webkit-scrollbar { width: 4px; }
        .stats-panel::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

        /* Hero Stats - Quick Glance */
        .hero-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1px;
            background: var(--border);
            border-bottom: 1px solid var(--border);
        }

        .hero-card {
            background: var(--surface);
            padding: 20px 16px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent);
            opacity: 0;
            transition: opacity 0.2s;
        }

        .hero-card:hover::before {
            opacity: 1;
        }

        .hero-card:hover {
            background: var(--surface-2);
        }

        .hero-value {
            font-family: var(--mono);
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--text);
            line-height: 1;
            margin-bottom: 6px;
        }

        .hero-value.accent {
            color: var(--accent);
        }

        .hero-label {
            font-family: var(--sans);
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        /* Stats Sections */
        .stats-section {
            padding: 16px;
            border-bottom: 1px solid var(--border);
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .section-title {
            font-family: var(--sans);
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .section-badge {
            font-family: var(--mono);
            font-size: 0.6rem;
            padding: 2px 6px;
            background: var(--surface-2);
            border: 1px solid var(--border);
            border-radius: 3px;
            color: var(--text-dim);
        }

        /* Detail Grid */
        .detail-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            background: var(--surface-2);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            transition: all 0.15s;
        }

        .detail-item:hover {
            border-color: var(--border-hover);
            background: var(--surface-3);
        }

        .detail-item.full-width {
            grid-column: 1 / -1;
        }

        .detail-label {
            font-family: var(--sans);
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .detail-value {
            font-family: var(--mono);
            font-size: 0.8rem;
            color: var(--text);
            font-weight: 500;
        }

        .detail-value.accent {
            color: var(--accent);
        }

        .detail-value.warning {
            color: var(--warning);
        }

        /* Progress Bars for Visual Feedback */
        .metric-bar {
            width: 100%;
            height: 3px;
            background: var(--surface-3);
            border-radius: 2px;
            margin-top: 8px;
            overflow: hidden;
        }

        .metric-bar-fill {
            height: 100%;
            background: var(--accent);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Word Analysis */
        .word-analysis {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .word-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 10px;
            background: var(--surface-2);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
        }

        .word-rank {
            font-family: var(--mono);
            font-size: 0.65rem;
            color: var(--text-dim);
            width: 20px;
            text-align: center;
        }

        .word-text {
            font-family: var(--mono);
            font-size: 0.8rem;
            color: var(--text);
            flex: 1;
            min-width: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .word-count {
            font-family: var(--mono);
            font-size: 0.75rem;
            color: var(--accent);
            font-weight: 600;
            min-width: 30px;
            text-align: right;
        }

        .word-bar-fill {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            background: var(--accent-dim);
            border-radius: var(--radius-sm);
            z-index: 0;
            opacity: 0.5;
        }

        .word-bar {
            position: relative;
            z-index: 1;
        }

        .word-bar > * {
            position: relative;
            z-index: 2;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-dim);
        }

        .empty-icon {
            font-size: 2rem;
            margin-bottom: 12px;
            opacity: 0.5;
        }

        .empty-text {
            font-family: var(--sans);
            font-size: 0.85rem;
        }

        /* Generator Panel */
        .generator-panel {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 16px;
            box-shadow: var(--shadow);
            display: none;
            flex-direction: column;
            gap: 12px;
            min-width: 280px;
            z-index: 100;
        }

        .generator-panel.show {
            display: flex;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: var(--sans);
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text);
        }

        .panel-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1.2rem;
            line-height: 1;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-sm);
            transition: all 0.15s;
        }

        .panel-close:hover {
            background: var(--surface-2);
            color: var(--text);
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .input-label {
            font-family: var(--sans);
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .input-field {
            font-family: var(--mono);
            font-size: 0.8rem;
            padding: 8px 10px;
            background: var(--surface-2);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text);
            width: 100%;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent);
        }

        select.input-field {
            cursor: pointer;
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--surface-3);
            border: 1px solid var(--border-hover);
            padding: 12px 20px;
            border-radius: var(--radius);
            font-family: var(--sans);
            font-size: 0.85rem;
            color: var(--text);
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast-icon {
            color: var(--accent);
        }

        /* Keyboard shortcuts hint */
        .kbd {
            font-family: var(--mono);
            font-size: 0.65rem;
            padding: 2px 5px;
            background: var(--surface-3);
            border: 1px solid var(--border);
            border-radius: 3px;
            color: var(--text-dim);
        }

        /* Responsive */
        @media (max-width: 900px) {
            .main { grid-template-columns: 1fr; grid-template-rows: 1fr auto; }
            .stats-panel { max-height: 40vh; border-top: 1px solid var(--border); }
            .hero-stats { grid-template-columns: repeat(3, 1fr); }
            .generator-panel { left: 10px; right: 10px; bottom: 10px; min-width: auto; }
        }

        /* Find/Replace Bar */
        .find-bar {
            display: none;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--surface-2);
            border-bottom: 1px solid var(--border);
        }

        .find-bar.show {
            display: flex;
        }

        .find-input {
            font-family: var(--mono);
            font-size: 0.8rem;
            padding: 6px 10px;
            background: var(--surface-3);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text);
            width: 200px;
        }

        .find-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .find-stats {
            font-family: var(--mono);
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-left: auto;
        }
    </style>
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="brand">
                <div class="brand-icon">TL</div>
                <span class="brand-text">TextLens</span>
                <span class="brand-tag">PRO</span>
            </div>
            
            <div class="header-center">
                <div class="quick-actions">
                    <button class="btn btn-icon" onclick="toggleGenerator()" title="Generate Text (G)">‚ö°</button>
                    <button class="btn" onclick="analyzeText()" title="Re-analyze (Ctrl+Enter)">
                        <span>Analyze</span>
                    </button>
                    <button class="btn" onclick="toggleFind()" title="Find (Ctrl+F)">
                        <span>Find</span>
                    </button>
                </div>
            </div>

            <div class="header-right">
                <button class="btn" onclick="copyStats()" title="Copy Stats (Ctrl+Shift+C)">
                    <span>üìã Copy</span>
                </button>
                <button class="btn" onclick="exportText()" title="Export (Ctrl+S)">
                    <span>üíæ Export</span>
                </button>
                <button class="btn btn-primary" onclick="clearText()" title="Clear (Esc)">
                    <span>Clear</span>
                </button>
            </div>
        </header>

        <div class="main">
            <div class="editor-section">
                <div class="find-bar" id="findBar">
                    <input type="text" class="find-input" id="findInput" placeholder="Find..." oninput="findInText()">
                    <input type="text" class="find-input" id="replaceInput" placeholder="Replace..." onkeydown="if(event.key==='Enter')replaceInText()">
                    <button class="btn" onclick="replaceInText()">Replace</button>
                    <button class="btn" onclick="replaceAll()">Replace All</button>
                    <span class="find-stats" id="findStats"></span>
                    <button class="btn btn-icon" onclick="toggleFind()" style="margin-left: auto;">‚úï</button>
                </div>

                <div class="editor-toolbar">
                    <div class="toolbar-group">
                        <button class="btn btn-icon" onclick="transformText('upper')" title="UPPERCASE">AA</button>
                        <button class="btn btn-icon" onclick="transformText('lower')" title="lowercase">aa</button>
                        <button class="btn btn-icon" onclick="transformText('title')" title="Title Case">Aa</button>
                        <button class="btn btn-icon" onclick="transformText('sentence')" title="Sentence case">A.</button>
                    </div>
                    <div class="toolbar-group">
                        <button class="btn" onclick="removeExtraSpaces()" title="Trim Spaces">üßπ Trim</button>
                        <button class="btn" onclick="removeLines()" title="Remove Empty Lines">üìÑ Compact</button>
                        <button class="btn" onclick="sortLines()" title="Sort Lines">üìä Sort</button>
                    </div>
                    <div class="toolbar-group">
                        <button class="btn" onclick="extractEmails()" title="Extract Emails">@ Emails</button>
                        <button class="btn" onclick="extractURLs()" title="Extract URLs">üîó URLs</button>
                        <button class="btn" onclick="extractNumbers()" title="Extract Numbers"># Numbers</button>
                    </div>
                </div>

                <div class="editor-wrapper">
                    <textarea id="textInput" placeholder="Paste your text here for instant analysis...&#10;&#10;Shortcuts:&#10;‚Ä¢ Ctrl+Enter = Analyze&#10;‚Ä¢ Ctrl+F = Find&#10;‚Ä¢ Ctrl+Shift+C = Copy Stats&#10;‚Ä¢ Esc = Clear" spellcheck="false"></textarea>
                    <div class="editor-status">
                        <span class="status-item" id="statusWords">0 words</span>
                        <span class="status-item" id="statusChars">0 chars</span>
                        <span class="status-item accent" id="statusTime">‚Äî</span>
                    </div>
                </div>
            </div>

            <div class="stats-panel">
                <!-- Hero Stats -->
                <div class="hero-stats">
                    <div class="hero-card">
                        <div class="hero-value accent" id="heroWords">0</div>
                        <div class="hero-label">Words</div>
                    </div>
                    <div class="hero-card">
                        <div class="hero-value" id="heroChars">0</div>
                        <div class="hero-label">Characters</div>
                    </div>
                    <div class="hero-card">
                        <div class="hero-value" id="heroTime">‚Äî</div>
                        <div class="hero-label">Read Time</div>
                    </div>
                </div>

                <!-- Core Metrics -->
                <div class="stats-section">
                    <div class="section-header">
                        <div class="section-title">üìä Core Metrics</div>
                        <span class="section-badge">LIVE</span>
                    </div>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <span class="detail-label">Sentences</span>
                            <span class="detail-value" id="statSentences">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Paragraphs</span>
                            <span class="detail-value" id="statParagraphs">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Lines</span>
                            <span class="detail-value" id="statLines">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Unique Words</span>
                            <span class="detail-value accent" id="statUnique">0</span>
                        </div>
                        <div class="detail-item full-width">
                            <span class="detail-label">Character Density</span>
                            <div style="flex:1; margin-left: 12px;">
                                <div class="metric-bar">
                                    <div class="metric-bar-fill" id="densityBar" style="width: 0%"></div>
                                </div>
                            </div>
                            <span class="detail-value" id="statDensity" style="margin-left: 10px;">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Character Breakdown -->
                <div class="stats-section">
                    <div class="section-header">
                        <div class="section-title">üî§ Characters</div>
                    </div>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <span class="detail-label">Letters</span>
                            <span class="detail-value" id="statLetters">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Numbers</span>
                            <span class="detail-value" id="statNumbers">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Spaces</span>
                            <span class="detail-value" id="statSpaces">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Punctuation</span>
                            <span class="detail-value" id="statPunct">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Special</span>
                            <span class="detail-value" id="statSpecial">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">No Spaces</span>
                            <span class="detail-value" id="statNoSpace">0</span>
                        </div>
                    </div>
                </div>

                <!-- Analysis -->
                <div class="stats-section">
                    <div class="section-header">
                        <div class="section-title">üìà Analysis</div>
                    </div>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <span class="detail-label">Avg Word Length</span>
                            <span class="detail-value accent" id="statAvgWord">‚Äî</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Avg Sentence</span>
                            <span class="detail-value" id="statAvgSent">‚Äî</span>
                        </div>
                        <div class="detail-item full-width">
                            <span class="detail-label">Longest Word</span>
                            <span class="detail-value warning" id="statLongest" style="max-width: 150px; overflow: hidden; text-overflow: ellipsis;">‚Äî</span>
                        </div>
                    </div>
                </div>

                <!-- Top Words -->
                <div class="stats-section">
                    <div class="section-header">
                        <div class="section-title">üèÜ Top Words</div>
                        <span class="section-badge" id="vocabBadge">0</span>
                    </div>
                    <div class="word-analysis" id="topWordsList">
                        <div class="empty-state">
                            <div class="empty-icon">üìù</div>
                            <div class="empty-text">Start typing to see word analysis</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Generator Panel -->
    <div class="generator-panel" id="generatorPanel">
        <div class="panel-header">
            <span>‚ö° Text Generator</span>
            <button class="panel-close" onclick="toggleGenerator()">√ó</button>
        </div>
        <div class="input-group">
            <label class="input-label">Character Count</label>
            <input type="number" class="input-field" id="genCount" value="500" min="1">
        </div>
        <div class="input-row">
            <div class="input-group">
                <label class="input-label">Type</label>
                <select class="input-field" id="genType">
                    <option value="text">Text</option>
                    <option value="numbers">Numbers</option>
                    <option value="mixed">Mixed</option>
                    <option value="lorem">Lorem Ipsum</option>
                    <option value="json">JSON Sample</option>
                    <option value="code">Code Sample</option>
                </select>
            </div>
            <div class="input-group">
                <label class="input-label">Case</label>
                <select class="input-field" id="genCase">
                    <option value="lower">lowercase</option>
                    <option value="upper">UPPERCASE</option>
                    <option value="title">Title Case</option>
                    <option value="sentence">Sentence case</option>
                </select>
            </div>
        </div>
        <button class="btn btn-primary" onclick="generateText()" style="width: 100%; justify-content: center;">
            Generate & Insert
        </button>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <span class="toast-icon">‚úì</span>
        <span id="toastMsg">Action completed</span>
    </div>

    <script>
        // State
        let currentText = '';
        let findMatches = [];
        let currentMatch = -1;

        // Initialize
        document.getElementById('textInput').addEventListener('input', debounce(analyzeText, 100));
        document.addEventListener('keydown', handleKeyboard);
        
        // Auto-analyze on load with sample
        setTimeout(() => {
            document.getElementById('textInput').value = "Welcome to TextLens Pro. This advanced text analyzer is designed for QA engineers and developers who need quick, accurate text metrics. Paste any content to see real-time statistics including word count, character analysis, reading time estimates, and vocabulary frequency distributions. Use keyboard shortcuts for blazing fast workflow.";
            analyzeText();
        }, 100);

        function debounce(fn, ms) {
            let timeout;
            return function(...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => fn.apply(this, args), ms);
            };
        }

        function handleKeyboard(e) {
            // Ctrl/Cmd + Enter = Analyze
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                analyzeText();
                toast('Analysis refreshed');
            }
            // Ctrl/Cmd + Shift + C = Copy stats
            if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'C') {
                e.preventDefault();
                copyStats();
            }
            // Ctrl/Cmd + F = Find
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                e.preventDefault();
                toggleFind();
            }
            // Esc = Clear or Close panels
            if (e.key === 'Escape') {
                if (document.getElementById('generatorPanel').classList.contains('show')) {
                    toggleGenerator();
                } else if (document.getElementById('findBar').classList.contains('show')) {
                    toggleFind();
                } else {
                    clearText();
                }
            }
        }

        function analyzeText() {
            const text = document.getElementById('textInput').value;
            currentText = text;
            
            // Basic counts
            const chars = text.length;
            const charsNoSpace = text.replace(/\s/g, '').length;
            const words = text.trim() ? text.trim().split(/\s+/).filter(w => w.length > 0) : [];
            const wordCount = words.length;
            
            // Sentences (improved regex)
            const sentences = text.split(/[.!?]+(?=\s|$)/).filter(s => s.trim().length > 0);
            const sentenceCount = sentences.length;
            
            // Paragraphs
            const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim().length > 0);
            const paragraphCount = paragraphs.length || (text.trim() ? 1 : 0);
            
            // Lines
            const lineCount = text.split('\n').length;
            
            // Character types
            const letters = (text.match(/[a-zA-Z]/g) || []).length;
            const numbers = (text.match(/[0-9]/g) || []).length;
            const spaces = (text.match(/\s/g) || []).length;
            const punct = (text.match(/[.,!?;:'"()[\]{}]/g) || []).length;
            const special = chars - letters - numbers - spaces - punct;
            
            // Calculated metrics
            const avgWordLen = wordCount > 0 ? (letters / wordCount).toFixed(1) : '‚Äî';
            const avgSentLen = sentenceCount > 0 ? Math.round(wordCount / sentenceCount) : '‚Äî';
            const longestWord = words.reduce((longest, w) => w.length > longest.length ? w.replace(/[^\w]/g, '') : longest, '‚Äî');
            const uniqueWords = new Set(words.map(w => w.toLowerCase().replace(/[^\w]/g, ''))).size;
            const density = chars > 0 ? Math.round((charsNoSpace / chars) * 100) : 0;
            
            // Reading time (200 wpm)
            let readTime = '‚Äî';
            if (wordCount > 0) {
                const minutes = wordCount / 200;
                if (minutes < 1) {
                    readTime = Math.ceil(minutes * 60) + 's';
                } else if (minutes < 60) {
                    const m = Math.floor(minutes);
                    const s = Math.round((minutes - m) * 60);
                    readTime = s > 0 ? `${m}m ${s}s` : `${m}m`;
                } else {
                    const h = Math.floor(minutes / 60);
                    const m = Math.round(minutes % 60);
                    readTime = `${h}h ${m}m`;
                }
            }
            
            // Update Hero Stats
            document.getElementById('heroWords').textContent = formatNumber(wordCount);
            document.getElementById('heroChars').textContent = formatNumber(chars);
            document.getElementById('heroTime').textContent = readTime;
            
            // Update Status Bar
            document.getElementById('statusWords').textContent = formatNumber(wordCount) + ' words';
            document.getElementById('statusChars').textContent = formatNumber(chars) + ' chars';
            document.getElementById('statusTime').textContent = readTime === '‚Äî' ? '‚Äî' : readTime + ' read';
            
            // Update Core Metrics
            document.getElementById('statSentences').textContent = formatNumber(sentenceCount);
            document.getElementById('statParagraphs').textContent = formatNumber(paragraphCount);
            document.getElementById('statLines').textContent = formatNumber(lineCount);
            document.getElementById('statUnique').textContent = formatNumber(uniqueWords);
            document.getElementById('statDensity').textContent = density + '%';
            document.getElementById('densityBar').style.width = density + '%';
            
            // Update Character Breakdown
            document.getElementById('statLetters').textContent = formatNumber(letters);
            document.getElementById('statNumbers').textContent = formatNumber(numbers);
            document.getElementById('statSpaces').textContent = formatNumber(spaces);
            document.getElementById('statPunct').textContent = formatNumber(punct);
            document.getElementById('statSpecial').textContent = formatNumber(special);
            document.getElementById('statNoSpace').textContent = formatNumber(charsNoSpace);
            
            // Update Analysis
            document.getElementById('statAvgWord').textContent = avgWordLen + (avgWordLen !== '‚Äî' ? ' ch' : '');
            document.getElementById('statAvgSent').textContent = avgSentLen + (avgSentLen !== '‚Äî' ? ' wds' : '');
            document.getElementById('statLongest').textContent = longestWord;
            
            // Update Top Words
            updateTopWords(words);
            
            // Update vocab badge
            document.getElementById('vocabBadge').textContent = uniqueWords + ' unique';
        }

        function updateTopWords(words) {
            const container = document.getElementById('topWordsList');
            
            if (words.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìù</div>
                        <div class="empty-text">Start typing to see word analysis</div>
                    </div>`;
                return;
            }
            
            // Calculate frequencies (ignore words <= 2 chars)
            const freq = {};
            let maxCount = 0;
            words.forEach(w => {
                const clean = w.toLowerCase().replace(/[^\w]/g, '');
                if (clean.length > 2) {
                    freq[clean] = (freq[clean] || 0) + 1;
                    maxCount = Math.max(maxCount, freq[clean]);
                }
            });
            
            const sorted = Object.entries(freq)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            if (sorted.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìä</div>
                        <div class="empty-text">No significant words found</div>
                    </div>`;
                return;
            }
            
            container.innerHTML = sorted.map(([word, count], index) => {
                const percentage = (count / maxCount) * 100;
                return `
                    <div class="word-bar">
                        <div class="word-bar-fill" style="width: ${percentage}%"></div>
                        <span class="word-rank">${index + 1}</span>
                        <span class="word-text">${escapeHtml(word)}</span>
                        <span class="word-count">${count}</span>
                    </div>
                `;
            }).join('');
        }

        function formatNumber(n) {
            return n.toLocaleString();
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Text Transformations
        function transformText(type) {
            const ta = document.getElementById('textInput');
            const text = ta.value;
            if (!text) return;
            
            let transformed;
            switch(type) {
                case 'upper':
                    transformed = text.toUpperCase();
                    break;
                case 'lower':
                    transformed = text.toLowerCase();
                    break;
                case 'title':
                    transformed = text.toLowerCase().replace(/\b\w/g, c => c.toUpperCase());
                    break;
                case 'sentence':
                    transformed = text.toLowerCase().replace(/(^\s*\w|[.!?]\s*\w)/g, c => c.toUpperCase());
                    break;
            }
            
            ta.value = transformed;
            analyzeText();
            toast(`Transformed to ${type} case`);
        }

        function removeExtraSpaces() {
            const ta = document.getElementById('textInput');
            ta.value = ta.value.replace(/\s+/g, ' ').trim();
            analyzeText();
            toast('Extra spaces removed');
        }

        function removeLines() {
            const ta = document.getElementById('textInput');
            ta.value = ta.value.split('\n').filter(line => line.trim()).join('\n');
            analyzeText();
            toast('Empty lines removed');
        }

        function sortLines() {
            const ta = document.getElementById('textInput');
            const lines = ta.value.split('\n');
            const sorted = lines.sort((a, b) => a.localeCompare(b, undefined, {sensitivity: 'base'}));
            ta.value = sorted.join('\n');
            analyzeText();
            toast('Lines sorted alphabetically');
        }

        // Extractors
        function extractEmails() {
            const text = document.getElementById('textInput').value;
            const emails = text.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g) || [];
            if (emails.length) {
                document.getElementById('textInput').value = emails.join('\n');
                analyzeText();
                toast(`Extracted ${emails.length} emails`);
            } else {
                toast('No emails found');
            }
        }

        function extractURLs() {
            const text = document.getElementById('textInput').value;
            const urls = text.match(/https?:\/\/[^\s]+|www\.[^\s]+/g) || [];
            if (urls.length) {
                document.getElementById('textInput').value = urls.join('\n');
                analyzeText();
                toast(`Extracted ${urls.length} URLs`);
            } else {
                toast('No URLs found');
            }
        }

        function extractNumbers() {
            const text = document.getElementById('textInput').value;
            const numbers = text.match(/\d+/g) || [];
            if (numbers.length) {
                document.getElementById('textInput').value = numbers.join('\n');
                analyzeText();
                toast(`Extracted ${numbers.length} numbers`);
            } else {
                toast('No numbers found');
            }
        }

        // Find/Replace
        function toggleFind() {
            const bar = document.getElementById('findBar');
            bar.classList.toggle('show');
            if (bar.classList.contains('show')) {
                document.getElementById('findInput').focus();
            }
        }

        function findInText() {
            const search = document.getElementById('findInput').value;
            const text = document.getElementById('textInput').value;
            const stats = document.getElementById('findStats');
            
            if (!search) {
                stats.textContent = '';
                return;
            }
            
            const regex = new RegExp(escapeRegex(search), 'gi');
            const matches = text.match(regex) || [];
            stats.textContent = `${matches.length} matches`;
        }

        function replaceInText() {
            const search = document.getElementById('findInput').value;
            const replace = document.getElementById('replaceInput').value;
            const ta = document.getElementById('textInput');
            
            if (!search) return;
            
            const regex = new RegExp(escapeRegex(search), 'g');
            const count = (ta.value.match(regex) || []).length;
            ta.value = ta.value.replace(regex, replace);
            analyzeText();
            toast(`Replaced ${count} occurrence${count !== 1 ? 's' : ''}`);
        }

        function replaceAll() {
            replaceInText();
        }

        function escapeRegex(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        // Generator
        function toggleGenerator() {
            const panel = document.getElementById('generatorPanel');
            panel.classList.toggle('show');
        }

        function generateText() {
            const count = parseInt(document.getElementById('genCount').value) || 500;
            const type = document.getElementById('genType').value;
            const caseMode = document.getElementById('genCase').value;
            
            let text = '';
            
            switch(type) {
                case 'text':
                    text = generateRandomText(count);
                    break;
                case 'numbers':
                    text = generateNumbers(count);
                    break;
                case 'mixed':
                    text = generateMixed(count);
                    break;
                case 'lorem':
                    text = generateLorem(count);
                    break;
                case 'json':
                    text = generateJSON(count);
                    break;
                case 'code':
                    text = generateCode(count);
                    break;
            }
            
            // Apply case
            switch(caseMode) {
                case 'upper':
                    text = text.toUpperCase();
                    break;
                case 'lower':
                    text = text.toLowerCase();
                    break;
                case 'title':
                    text = text.toLowerCase().replace(/\b\w/g, c => c.toUpperCase());
                    break;
            }
            
            document.getElementById('textInput').value = text;
            analyzeText();
            toggleGenerator();
            toast(`Generated ${type} text (${count} chars)`);
        }

        function generateRandomText(count) {
            const words = ['lorem', 'ipsum', 'dolor', 'sit', 'amet', 'consectetur', 'adipiscing', 'elit', 'sed', 'do', 'eiusmod', 'tempor', 'incididunt', 'ut', 'labore', 'et', 'dolore', 'magna', 'aliqua', 'ut', 'enim', 'ad', 'minim', 'veniam', 'quis', 'nostrud', 'exercitation', 'ullamco', 'laboris', 'nisi', 'aliquip', 'ex', 'ea', 'commodo', 'consequat', 'duis', 'aute', 'irure', 'in', 'reprehenderit', 'voluptate', 'velit', 'esse', 'cillum', 'fugiat', 'nulla', 'pariatur', 'excepteur', 'sint', 'occaecat', 'cupidatat', 'non', 'proident', 'sunt', 'culpa', 'qui', 'officia', 'deserunt', 'mollit', 'anim', 'id', 'est', 'laborum'];
            let result = '';
            while (result.length < count) {
                const word = words[Math.floor(Math.random() * words.length)];
                if (result.length > 0) result += ' ';
                result += word;
            }
            return result.charAt(0).toUpperCase() + result.slice(1) + '.';
        }

        function generateNumbers(count) {
            let result = '';
            while (result.length < count) {
                if (result.length > 0) result += ' ';
                result += Math.floor(Math.random() * 1000000).toString();
            }
            return result.slice(0, count);
        }

        function generateMixed(count) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < count; i++) {
                if (i > 0 && i % 5 === 0) result += ' ';
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function generateLorem(count) {
            const paragraphs = [
                "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",
                "Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
                "Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.",
                "Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."
            ];
            let result = '';
            while (result.length < count) {
                result += paragraphs[Math.floor(Math.random() * paragraphs.length)] + ' ';
            }
            return result.slice(0, count);
        }

        function generateJSON(count) {
            const templates = [
                '{"id": 1, "name": "John Doe", "email": "john@example.com", "active": true}',
                '{"id": 2, "name": "Jane Smith", "email": "jane@example.com", "active": false}',
                '{"users": [{"name": "Alice"}, {"name": "Bob"}], "count": 2}',
                '{"status": "success", "data": {"id": 123, "value": "test"}}'
            ];
            let result = '';
            while (result.length < count) {
                result += templates[Math.floor(Math.random() * templates.length)] + '\n';
            }
            return result.slice(0, count);
        }

        function generateCode(count) {
            const lines = [
                'function processData(input) {',
                '  const result = input.map(x => x * 2);',
                '  return result.filter(x => x > 10);',
                '}',
                'const data = [1, 2, 3, 4, 5];',
                'console.log(processData(data));',
                'class User {',
                '  constructor(name) { this.name = name; }',
                '  greet() { return `Hello ${this.name}`; }',
                '}'
            ];
            let result = '';
            while (result.length < count) {
                result += lines[Math.floor(Math.random() * lines.length)] + '\n';
            }
            return result.slice(0, count);
        }

        // Utilities
        function clearText() {
            document.getElementById('textInput').value = '';
            analyzeText();
            toast('Editor cleared');
        }

        function copyStats() {
            const stats = `TextLens Pro Analysis
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Words:      ${document.getElementById('heroWords').textContent}
Characters: ${document.getElementById('heroChars').textContent}
Reading:    ${document.getElementById('heroTime').textContent}
Sentences:  ${document.getElementById('statSentences').textContent}
Paragraphs: ${document.getElementById('statParagraphs').textContent}
Unique:     ${document.getElementById('statUnique').textContent}
Avg Word:   ${document.getElementById('statAvgWord').textContent}
Longest:    ${document.getElementById('statLongest').textContent}`;
            
            navigator.clipboard.writeText(stats).then(() => {
                toast('Statistics copied to clipboard');
            });
        }

        function exportText() {
            const text = document.getElementById('textInput').value;
            if (!text) {
                toast('Nothing to export');
                return;
            }
            
            const blob = new Blob([text], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `text-analysis-${new Date().toISOString().slice(0,10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            toast('File exported successfully');
        }

        function toast(message) {
            const t = document.getElementById('toast');
            document.getElementById('toastMsg').textContent = message;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2500);
        }
    </script>
</body>
</html>